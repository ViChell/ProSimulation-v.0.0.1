# üîç –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ë–æ–π–æ–≤–∏—Ö –î—ñ–π

## –ü—Ä–æ–±–ª–µ–º–∞: "–ß–æ–º—É –Ω–µ–º–∞—î –ø–æ—Å—Ç—Ä—ñ–ª—ñ–≤?"

–í–∏ –ø–æ–º—ñ—Ç–∏–ª–∏, —â–æ –ø—ñ–¥ —á–∞—Å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è `Shots: 0, Hits: 0`. –¶–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –Ω–∞ –ø–æ—á–∞—Ç–∫—É, –æ—Å—å —á–æ–º—É:

### üéØ –ü—Ä–∏—á–∏–Ω–∏

**1. –Æ–Ω—ñ—Ç–∏ –∑–∞–Ω–∞–¥—Ç–æ –¥–∞–ª–µ–∫–æ**
- –£ —Ñ–∞–π–ª—ñ `data/objects.xlsx` —é–Ω—ñ—Ç–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—ñ 15-20 –∫–º
- –î–∞–ª—å–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏ —Ç–∞–Ω–∫—ñ–≤: 2.5 –∫–º
- –î–∞–ª—å–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏ –ë–ú–ü: 1.8 –∫–º
- –ê–≥–µ–Ω—Ç–∏ –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ—Å—è–≥–∞—é—Ç—å –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ!

**2. –í–∏–ø–∞–¥–∫–æ–≤—ñ –¥—ñ—ó**
- –ù–µ–≤—á–µ–Ω–∏–π –∞–≥–µ–Ω—Ç –æ–±–∏—Ä–∞—î –≤–∏–ø–∞–¥–∫–æ–≤—ñ –¥—ñ—ó
- 9 –∑ 13 –¥—ñ–π - —Ü–µ —Ä—É—Ö
- –¢—ñ–ª—å–∫–∏ 3 –¥—ñ—ó - –∞—Ç–∞–∫–∞
- –ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤–∏—Å—Ç—Ä—ñ–ª—É: ~23%

**3. –ê–≥–µ–Ω—Ç —â–µ –Ω–µ –Ω–∞–≤—á–∏–≤—Å—è**
- RL –∞–≥–µ–Ω—Ç –Ω–∞ –ø–æ—á–∞—Ç–∫—É –Ω–µ –∑–Ω–∞—î, —â–æ —Ä–æ–±–∏—Ç–∏
- –í—ñ–Ω –¥–æ—Å–ª—ñ–¥–∂—É—î (exploration)
- –ü—ñ—Å–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –Ω–∞–≤—á–∏—Ç—å—Å—è –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –∫–æ–ª–∏ —Ç—Ä–µ–±–∞

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è: –¢–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –¥–µ —é–Ω—ñ—Ç–∏ –±–ª–∏–∑—å–∫–æ:

```bash
python create_test_scenario.py
```

–¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å `data/test_objects.xlsx` –∑:
- 3 —é–Ω—ñ—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–∏ A
- 3 —é–Ω—ñ—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–∏ B
- –í—ñ–¥—Å—Ç–∞–Ω—å: ~2 –∫–º (–≤ —Ä–∞–¥—ñ—É—Å—ñ –∞—Ç–∞–∫–∏!)

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è

### –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é:

```bash
python visualize_training.py
```

**–ú–µ–Ω—é:**
1. **–í–∏–ø–∞–¥–∫–æ–≤–∏–π –∞–≥–µ–Ω—Ç** - –¥–µ—Ç–∞–ª—å–Ω–∏–π –ª–æ–≥ –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É
2. **–ù–∞–≤—á–µ–Ω–∏–π –∞–≥–µ–Ω—Ç** - –ª–æ–≥ –Ω–∞—Ç—Ä–µ–Ω–æ–≤–∞–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
3. **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è** - –≤–∏–ø–∞–¥–∫–æ–≤–∏–π vs –Ω–∞–≤—á–µ–Ω–∏–π
4. **–®–≤–∏–¥–∫–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è** - —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é –¥–æ/–ø—ñ—Å–ª—è

### –©–æ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ:

```
–ö—Ä–æ–∫ 15:
  –î—ñ—è: Attack Nearest (#9)
  –í–∏–Ω–∞–≥–æ—Ä–æ–¥–∞: +1.100
  üí• –ü–û–°–¢–†–Ü–õ! –í–ª—É—á–∏–≤!
  ‚ò†Ô∏è  –í–ë–ò–í–°–¢–í–û! (+1)
  HP: 100.0 (100.0%)
  –ü–æ–∑–∏—Ü—ñ—è: (36.500, 47.500)
  –í–æ—Ä–æ–≥–∏ –≤ —Ä–∞–¥—ñ—É—Å—ñ: 2
  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 1 –≤–±–∏–≤—Å—Ç–≤, 3/5 –≤–ª—É—á–µ–Ω—å
```

---

## üìä –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç –±–æ—é

–ü—Ä–æ—Å—Ç–∏–π —Ç–µ—Å—Ç –∑ —Ç–µ—Å—Ç–æ–≤–∏–º —Å—Ü–µ–Ω–∞—Ä—ñ—î–º:

```bash
python test_combat.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
–ö—Ä–æ–∫  8: üéØ Attack Near | HP:  85.0 | –í–æ—Ä–æ–≥–∏: 2 | K:0 S:1 H:0 | ‚ùå –ü—Ä–æ–º–∞—Ö
–ö—Ä–æ–∫  9: üéØ Attack Near | HP:  85.0 | –í–æ—Ä–æ–≥–∏: 2 | K:1 S:2 H:1 | üí• –í–õ–£–ß–ò–í! ‚ò†Ô∏è  –í–ë–ò–í! (+1)
–ö—Ä–æ–∫ 10: üéØ Attack Weak | HP:  85.0 | –í–æ—Ä–æ–≥–∏: 1 | K:1 S:3 H:1 | ‚ùå –ü—Ä–æ–º–∞—Ö
```

---

## üéÆ –Ø–∫ –±–∞—á–∏—Ç–∏ —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

### 1. –ö–æ–Ω—Å–æ–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥

–î–æ–¥–∞–π—Ç–µ `verbose=1` –¥–æ PPO:

```python
model = PPO('MlpPolicy', env, verbose=1)
```

–ü–æ–±–∞—á–∏—Ç–µ:
```
| time/              |           |
|    fps             | 127       |
|    iterations      | 100       |
|    time_elapsed    | 1606      |
|    total_timesteps | 204800    |
| train/             |           |
|    approx_kl       | 0.0069    |
|    clip_fraction   | 0.058     |
|    policy_loss     | -0.0152   |
|    value_loss      | 48.3      |
```

### 2. TensorBoard

```bash
tensorboard --logdir models/
```

–í—ñ–¥–∫—Ä–∏–π—Ç–µ: http://localhost:6006

–ì—Ä–∞—Ñ—ñ–∫–∏:
- **rollout/ep_rew_mean** - —Å–µ—Ä–µ–¥–Ω—è –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∞
- **rollout/ep_len_mean** - –¥–æ–≤–∂–∏–Ω–∞ –µ–ø—ñ–∑–æ–¥—É
- **train/policy_loss** - loss policy
- **train/value_loss** - loss value function

### 3. Custom Callback

–°—Ç–≤–æ—Ä—ñ—Ç—å callback –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è:

```python
from stable_baselines3.common.callbacks import BaseCallback

class CombatLogger(BaseCallback):
    def _on_step(self):
        # –õ–æ–≥—É–π—Ç–µ –∫–æ–∂–µ–Ω –∫—Ä–æ–∫
        if self.locals.get('infos'):
            for info in self.locals['infos']:
                if 'kills' in info:
                    print(f"Kills: {info['kills']}, HP: {info['hp']}")
        return True

model.learn(total_timesteps=10000, callback=CombatLogger())
```

---

## üìà –Ø–∫ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ –∞–≥–µ–Ω—Ç –Ω–∞–≤—á–∞—î—Ç—å—Å—è?

### –ü–æ–∫–∞–∑–Ω–∏–∫–∏ —É—Å–ø—ñ—Ö—É:

**1. –í–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –∑—Ä–æ—Å—Ç–∞—î**
- –ü–æ—á–∞—Ç–æ–∫: -50 –¥–æ 0
- –ü—ñ—Å–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è: +20 –¥–æ +100

**2. –¢–æ—á–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫ –ø–æ–∫—Ä–∞—â—É—î—Ç—å—Å—è**
- –í–∏–ø–∞–¥–∫–æ–≤–∏–π: 10-20%
- –ù–∞–≤—á–µ–Ω–∏–π: 40-60%

**3. –ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è**
- –í–∏–ø–∞–¥–∫–æ–≤–∏–π: 5-10 –∫—Ä–æ–∫—ñ–≤
- –ù–∞–≤—á–µ–Ω–∏–π: 50-100+ –∫—Ä–æ–∫—ñ–≤

**4. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤–±–∏–≤—Å—Ç–≤ –∑—Ä–æ—Å—Ç–∞—î**
- –í–∏–ø–∞–¥–∫–æ–≤–∏–π: 0-1
- –ù–∞–≤—á–µ–Ω–∏–π: 2-5+

---

## üõ†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –∫—Ä–∞—â–æ—ó –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –ó–º–µ–Ω—à—ñ—Ç—å —Ä–æ–∑–º—ñ—Ä —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```python
env = CombatRLEnvironment(
    objects_file='data/test_objects.xlsx',  # –¢–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π!
    rules_file='data/sets.xlsx',
    controlled_side='A',
    max_steps=100  # –ú–µ–Ω—à–µ –∫—Ä–æ–∫—ñ–≤ = —à–≤–∏–¥—à–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
)
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –º–µ–Ω—à–µ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â

```bash
python train_rl.py --mode train --timesteps 10000 --n-envs 1
```

–¶–µ –¥–∞—Å—Ç—å –±—ñ–ª—å—à —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ –≤ –∫–æ–Ω—Å–æ–ª—ñ.

### –£–≤—ñ–º–∫–Ω—ñ—Ç—å –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è

–£ `simulation/model.py` –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å:

```python
# Simulation parameters
ENABLE_COMBAT_LOG = True  # –í–∏–º–∫–Ω–µ–Ω–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
```

---

## üìù –ü—Ä–∏–∫–ª–∞–¥ –ø–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª—É

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π
python create_test_scenario.py

# 2. –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç –±–æ—é
python test_combat.py

# 3. –î–µ—Ç–∞–ª—å–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
python visualize_training.py
# –û–±–µ—Ä—ñ—Ç—å: 1 (–í–∏–ø–∞–¥–∫–æ–≤–∏–π –∞–≥–µ–Ω—Ç)

# 4. –®–≤–∏–¥–∫–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
python visualize_training.py
# –û–±–µ—Ä—ñ—Ç—å: 4 (–®–≤–∏–¥–∫–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é)

# 5. –ü–æ–≤–Ω–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
python train_rl.py --mode train --timesteps 10000

# 6. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è
python visualize_training.py
# –û–±–µ—Ä—ñ—Ç—å: 3 (–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤–∏–ø–∞–¥–∫–æ–≤–∏–π vs –Ω–∞–≤—á–µ–Ω–∏–π)
```

---

## üéØ –í–∏—Å–Ω–æ–≤–æ–∫

**–ß–æ–º—É –Ω–µ –±—É–ª–æ –ø–æ—Å—Ç—Ä—ñ–ª—ñ–≤:**
1. ‚úÖ –Æ–Ω—ñ—Ç–∏ –±—É–ª–∏ –∑–∞–Ω–∞–¥—Ç–æ –¥–∞–ª–µ–∫–æ (15+ –∫–º)
2. ‚úÖ –í–∏–ø–∞–¥–∫–æ–≤–∏–π –∞–≥–µ–Ω—Ç –æ–±–∏—Ä–∞—î —Ä—É—Ö —á–∞—Å—Ç—ñ—à–µ –Ω—ñ–∂ –∞—Ç–∞–∫—É
3. ‚úÖ –ê–≥–µ–Ω—Ç –Ω–µ –Ω–∞–≤—á–∏–≤—Å—è –∫–æ–ª–∏ –∞—Ç–∞–∫—É–≤–∞—Ç–∏

**–Ø–∫ –±–∞—á–∏—Ç–∏ –±—ñ–π:**
1. ‚úÖ –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π: `python create_test_scenario.py`
2. ‚úÖ –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é: `python visualize_training.py`
3. ‚úÖ –¢—Ä–µ–Ω—É–π—Ç–µ –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
4. ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ TensorBoard –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

**–ü—ñ—Å–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è:**
- –ê–≥–µ–Ω—Ç –Ω–∞–≤—á–∏—Ç—å—Å—è –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –∫–æ–ª–∏ —î —Ü—ñ–ª—å –≤ —Ä–∞–¥—ñ—É—Å—ñ
- –¢–æ—á–Ω—ñ—Å—Ç—å –ø–æ–∫—Ä–∞—â–∏—Ç—å—Å—è
- –ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è –∑–±—ñ–ª—å—à–∏—Ç—å—Å—è
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤–±–∏–≤—Å—Ç–≤ –∑—Ä–æ—Å—Ç–µ

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó

```bash
# –ö—Ä–æ–∫ 1: –¢–µ—Å—Ç–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π
python create_test_scenario.py

# –ö—Ä–æ–∫ 2: –ü–æ–±–∞—á–∏—Ç–∏ –±—ñ–π
python test_combat.py

# –ö—Ä–æ–∫ 3: –î–µ—Ç–∞–ª—å–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
python visualize_training.py

# –ö—Ä–æ–∫ 4: –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
python train_rl.py --mode train --timesteps 10000

# –ö—Ä–æ–∫ 5: TensorBoard
tensorboard --logdir models/
```

**–¢–µ–ø–µ—Ä –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤—Å–µ, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è! üéÆüîç**
